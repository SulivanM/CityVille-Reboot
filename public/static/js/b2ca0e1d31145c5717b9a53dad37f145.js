function sendRequest(h,g,f,e){var b=ZY.PrepareURL("viralRequest.php?action="+h);var d=g.join(",");var a=JSON.stringify(f);var c=JSON.stringify(e);$.post(b,{recipients:d,data:a,ontology:c},completeSendRequest);return true}function completeSendRequest(b){b=$.parseJSON(b);var a=b.proceedWithSend;if(a!=true){onRequestSent("no_recipients",null,b.requestData,[]);return true}addModalItem();SNAPI.api("request.send",{gameId:SNAPI.getCurrentGameId(1),toZid:b.toZid,type:b.type,data:{title:b.title,data:b.requestData,image:b.image,body:b.body,button_href:b.acceptUrlR2,button_post:b.acceptUrlR2,button_text:b.buttonText,button_text_short:"button_text_short",key:b.signature,senderID:SNAPI.getCurrentUserId()},eventTypeId:b.eventTypeId,zid:SNAPI.getCurrentUserId()},function(f){var e="none";var c;var j=[];var g="";if(f===undefined||f===null){e="send_requests return null"}else{if(typeof f=="string"){e=f}else{if(typeof f=="object"){if(f.hasOwnProperty(SNAPI.FACEBOOK)){g=f[SNAPI.FACEBOOK]}for(var i in f[SNAPI.ZGN]){if(f[SNAPI.ZGN].hasOwnProperty(i)){j.push(i)}}c=j.join(",");var h=ZY.PrepareURL(b.sentPostUrl);var d=b.postData;d.tab="flash";d.error=e;d.recipients=c;d.fbRequestId=g;$.post(h,d)}}}if(b.hasOwnProperty("byPassClient")){window.location.hash="switchToFlash"}else{onRequestSent(e,b.type,b.requestData,j);removeModalItem()}},true);beginBackupModelTimeout();return true};